<%- include('../../views/partials/admin/header') %>

<!-- Main Content Area -->
<div class="col-md-10">

  <!-- Page Header -->
  <div class="d-flex flex-column flex-md-row justify-content-between align-items-start align-items-md-center p-3 border-bottom mb-4 gap-3">
    <h1 class="h2 mb-0 fw-bold">Sales Report</h1>
  </div>

  

  <!-- KPI GRID START -->
  <div class="row g-4 mb-4">

    <!-- 1. Total Revenue (Gross) -->
    <div class="col-12 col-sm-6 col-lg-4 col-xl-3">
      <div class="card shadow-sm border-0 h-100 text-center p-3">
        <i class="bi bi-cash-coin text-success" style="font-size: 2.5rem;"></i>
        <h6 class="text-muted mt-2">Total Revenue (Gross)</h6>
        <h3 class="fw-bold text-success">₹<%=kpis.grossRevenue.toFixed(2) %>/-</h3>
      </div>
    </div>

    <!-- 2. Net Revenue -->
    <div class="col-12 col-sm-6 col-lg-4 col-xl-3">
      <div class="card shadow-sm border-0 h-100 text-center p-3">
        <i class="bi bi-wallet2 text-primary" style="font-size: 2.5rem;"></i>
        <h6 class="text-muted mt-2">Net Revenue</h6>
        <h3 class="fw-bold text-primary">₹<%=kpis.netRevenue.toFixed(2) %>/-</h3>
      </div>
    </div>

    <!-- 3. Total Orders -->
    <div class="col-12 col-sm-6 col-lg-4 col-xl-3">
      <div class="card shadow-sm border-0 h-100 text-center p-3">
        <i class="bi bi-bag-check text-dark" style="font-size: 2.5rem;"></i>
        <h6 class="text-muted mt-2">Total Orders</h6>
        <h3 class="fw-bold text-info"><%= kpis.totalOrders %></h3>
      </div>
    </div>

    <!-- 4. Delivered Orders -->
    <div class="col-12 col-sm-6 col-lg-4 col-xl-3">
      <div class="card shadow-sm border-0 h-100 text-center p-3">
        <i class="bi bi-truck text-success" style="font-size: 2.5rem;"></i>
        <h6 class="text-muted mt-2">Delivered Orders</h6>
        <h3 class="fw-bold text-success"><%= kpis.deliveredOrders %></h3>
      </div>
    </div>

    <!-- 5. Cancelled Orders -->
    <div class="col-12 col-sm-6 col-lg-4 col-xl-3">
      <div class="card shadow-sm border-0 h-100 text-center p-3">
        <i class="bi bi-x-octagon text-danger" style="font-size: 2.5rem;"></i>
        <h6 class="text-muted mt-2">Cancelled Orders</h6>
        <h3 class="fw-bold text-danger"><%= kpis.cancelledOrders %></h3>
      </div>
    </div>

    <!-- 6. Returned Orders -->
    <div class="col-12 col-sm-6 col-lg-4 col-xl-3">
      <div class="card shadow-sm border-0 h-100 text-center p-3">
        <i class="bi bi-arrow-return-left text-warning" style="font-size: 2.5rem;"></i>
        <h6 class="text-muted mt-2">Returned Orders</h6>
        <h3 class="fw-bold text-dark"><%= kpis.returnedOrders %></h3>
      </div>
    </div>

    <!-- 7. Total Discount -->
    <div class="col-12 col-sm-6 col-lg-4 col-xl-3">
      <div class="card shadow-sm border-0 h-100 text-center p-3">
        <i class="bi bi-ticket-perforated text-danger" style="font-size: 2.5rem;"></i>
        <h6 class="text-muted mt-2">Total Discount</h6>
        <h3 class="fw-bold text-danger">₹<%= (kpis.totalDiscountFromOffers + kpis.totalCouponDiscount).toFixed(2) %>/-</h3>
      </div>
    </div>

    <!-- 8. Coupon Deductions -->
    <div class="col-12 col-sm-6 col-lg-4 col-xl-3">
      <div class="card shadow-sm border-0 h-100 text-center p-3">
        <i class="bi bi-percent text-info" style="font-size: 2.5rem;"></i>
        <h6 class="text-muted mt-2">Coupon Deductions</h6>
        <h3 class="fw-bold text-primary">₹<%= kpis.totalCouponDiscount.toFixed(2) %>/-</h3>
      </div>
    </div>

    <!-- 9. Cancelled Items -->
<div class="col-12 col-sm-6 col-lg-4 col-xl-3">
  <div class="card shadow-sm border-0 h-100 text-center p-3">
    <i class="bi bi-arrow-counterclockwise text-warning" style="font-size: 2.5rem;"></i>
    <h6 class="text-muted mt-2">Total Cancelled Items</h6>
    <h3 class="fw-bold text-danger"><%= kpis.cancelledItems %></h3>
  </div>
</div>

<!-- 10. Returned Items -->
<div class="col-12 col-sm-6 col-lg-4 col-xl-3">
  <div class="card shadow-sm border-0 h-100 text-center p-3">
    <i class="bi bi-slash-circle text-danger" style="font-size: 2.5rem;"></i>
    <h6 class="text-muted mt-2">Total Returned Items</h6>
    <h3 class="fw-bold text-dark"><%= kpis.returnedItems %></h3>
  </div>
</div>

<!-- 11. Total Customers -->
<div class="col-12 col-sm-6 col-lg-4 col-xl-3">
  <div class="card shadow-sm border-0 h-100 text-center p-3">
    <i class="bi bi-people text-secondary" style="font-size: 2.5rem;"></i>
    <h6 class="text-muted mt-2">Total Customers</h6>
    <h3 class="fw-bold text-info"><%= totalCustomers %></h3>
  </div>
</div>

<!-- 12. Total Shipping Charges Collected -->
<div class="col-12 col-sm-6 col-lg-4 col-xl-3">
  <div class="card shadow-sm border-0 h-100 text-center p-3">
    <i class="bi bi-box-seam text-primary" style="font-size: 2.5rem;"></i>
    <h6 class="text-muted mt-2">Shipping Charges Collected</h6>
    <h3 class="fw-bold text-primary">₹<%=kpis.totalShippingCharge.toFixed(2) %>/-</h3>
  </div>
</div>


  </div>
  <!-- KPI GRID END -->

  <!-- Sales Trend Chart Placeholder -->
  <div class="card shadow-sm border-0 mb-4">
    <div class="card-header bg-light">
      <h5 class="mb-0 fw-semibold">Sales Trend</h5>
    </div>
    <div class="card-body">
      <div class="text-center py-5">
        <i class="bi bi-bar-chart-line text-primary" style="font-size: 4rem;"></i>
        <p class="text-muted mt-3">Sales trend chart will be displayed here</p>
      </div>
    </div>
  </div>

  

  <!-- Sales Table -->
  <div class="card shadow-sm border-0">
  <div class="card-header bg-light d-flex justify-content-between align-items-center">
    <h5 class="mb-0 fw-semibold">Detailed Sales Report</h5>

    <div class="ms-auto d-flex flex-wrap gap-2">
      <button id="downloadPdfBtn" class="btn btn-outline-danger d-flex align-items-center gap-2">
        <i class="bi bi-filetype-pdf"></i> Download PDF
      </button>

      <button id="downloadExcelBtn" class="btn btn-outline-success d-flex align-items-center gap-2">
        <i class="bi bi-filetype-xlsx"></i> Download Excel
      </button>
    </div>
  </div>

    <!-- Date Filters -->
  <div class="card mb-4 shadow-sm border-0">
    <div class="card-body">
      <div class="d-flex flex-column flex-md-row align-items-start align-items-md-center justify-content-between gap-3">

        <!-- Radio Filters -->
        <div class="btn-group" role="group" aria-label="Date Filters">
          <input type="radio" class="btn-check" name="range" id="daily">
          <label class="btn btn-outline-secondary" for="daily">Daily</label>

          <input type="radio" class="btn-check" name="range" id="weekly" checked>
          <label class="btn btn-outline-secondary" for="weekly">Weekly</label>

          <input type="radio" class="btn-check" name="range" id="monthly">
          <label class="btn btn-outline-secondary" for="monthly">Monthly</label>

          <input type="radio" class="btn-check" name="range" id="yearly">
          <label class="btn btn-outline-secondary" for="yearly">Yearly</label>

          <input type="radio" class="btn-check" name="range" id="custom">
          <label class="btn btn-outline-secondary" for="custom">Custom</label>
        </div>

        <!-- Custom Date Range -->
        <div class="d-flex gap-2 align-items-center" id="customDateInputs" style="display: none;">
          <input type="date" class="form-control" id="startDate">
          <input type="date" class="form-control" id="endDate">
        </div>

        <!-- Generate Button -->
        <button id="generateReportBtn" class="btn btn-primary">
          Generate Report
        </button>
      </div>
    </div>
  </div>
    <div class="card-body p-0">
      <div class="table-responsive">
        <table class="table table-hover mb-0">
          <thead class="table-light">
            <tr>
              <th>Order ID</th>
              <th>Date</th>
              <th>Customer</th>
              <th class="text-end">Gross Amount</th>
              <th class="text-end">Discount</th>
              <th class="text-end">Net Amount</th>
              <th class="text-center">Status</th>
            </tr>
          </thead>
          <tbody id="salesTableBody">
            <!-- Data rendered dynamically -->
          </tbody>
          <tfoot class="table-light">
            <tr class="fw-bold">
              <td colspan="3">TOTAL</td>
              <td class="text-end">₹1,301.50</td>
              <td class="text-end text-danger">-₹85.00</td>
              <td class="text-end">₹1,216.50</td>
              <td></td>
            </tr>
          </tfoot>
        </table>
      </div>
    </div>
  </div>

</div>

<style>
  .text-purple { color: #9c27b0; }
</style>

<script>
  // Show custom date inputs only if custom is selected
  document.getElementById("custom").addEventListener("change", () => {
    document.getElementById("customDateInputs").style.display = "flex";
  });

  ["daily", "weekly", "monthly", "yearly"].forEach(id => {
    document.getElementById(id).addEventListener("change", () => {
      document.getElementById("customDateInputs").style.display = "none";
    });
  });
</script>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

<%- include('../../views/partials/admin/footer') %>
